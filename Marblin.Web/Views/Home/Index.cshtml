@model Marblin.Web.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Luxury Marble & Stone";
}

<!-- Hero Section (Split Layout) -->
<div class="hero-section-wrapper position-relative">
    <!-- Desktop Hero (d-md-flex) -->
    <div class="row g-0 hero-split-layout d-none d-md-flex">
        <div class="col-lg-5 hero-text-side text-white d-flex flex-column justify-content-center">
            <div class="animate-fade-in-up">
                <h1 class="display-3 fw-bold mb-4 serif-font text-white letter-spacing-1">@Model.Settings.HeroHeadline</h1>
                <p class="lead mb-5 fs-5 text-white-50 delay-100" style="max-width: 500px;">@Model.Settings.HeroSubheadline</p>
                <div class="d-flex gap-3 delay-200">
                     <a asp-controller="Catalog" asp-action="Index" class="btn btn-light btn-lg px-5 py-3 rounded-0 fw-bold">Shop Collection</a>
                     <a asp-controller="CustomRequest" asp-action="Create" class="btn btn-outline-light btn-lg px-5 py-3 rounded-0" style="border-color: rgba(255,255,255,0.3);">Custom Design</a>
                </div>
            </div>
        </div>
        <div class="col-lg-7 hero-image-side">
            <div class="h-100 w-100 overflow-hidden position-relative">
                @if (!string.IsNullOrEmpty(Model.Settings.HeroImageUrl))
                {
                    <img src="@Model.Settings.HeroImageUrl" alt="Luxury Marble" class="w-100 h-100 object-fit-cover" style="object-position: center;" />
                }
                else
                {
                    <img src="/images/hero-bg.jpg" alt="Luxury Marble" class="w-100 h-100 object-fit-cover" onerror="this.src='https://placehold.co/1920x1080/1a1a1a/FFF?text=Luxury+Marble'" />
                }
                <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(90deg, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0) 50%);"></div>
            </div>
        </div>
    </div>

    <!-- Mobile Hero Carousel (d-md-none) -->
    <div id="heroMobileCarousel" class="carousel slide d-md-none hero-mobile-container carousel-fade" data-bs-ride="carousel" data-bs-pause="false">
        <div class="carousel-inner h-100">
            <!-- Slide 1: Hero Image (FIRST) -->
            <div class="carousel-item active h-100" data-bs-interval="3500">
                <div class="hero-mobile-image">
                    @if (!string.IsNullOrEmpty(Model.Settings.HeroImageUrl))
                    {
                        <img src="@Model.Settings.HeroImageUrl" alt="Luxury Marble" class="zoom-effect" />
                    }
                    else
                    {
                        <img src="/images/hero-bg.jpg" alt="Luxury Marble" class="zoom-effect" onerror="this.src='https://placehold.co/800x1200/1a1a1a/FFF?text=Luxury+Marble'" />
                    }
                    <div class="position-absolute top-0 start-0 w-100 h-100" style="background: rgba(0,0,0,0.2);"></div>
                </div>
            </div>
            <!-- Slide 2: Main Text/Content (SECOND) -->
            <div class="carousel-item h-100" data-bs-interval="10000">
                <div class="hero-mobile-text">
                    <h1 class="serif-font display-4 mb-4 animate-fade-in-up">@Model.Settings.HeroHeadline</h1>
                    <p class="px-4 text-white-50 mb-5 animate-fade-in-up delay-100">@Model.Settings.HeroSubheadline</p>
                    <div class="d-grid gap-3 w-75 animate-fade-in-up delay-200">
                        <a asp-controller="Catalog" asp-action="Index" class="btn btn-outline-light hero-btn-mobile">Shop Collection</a>
                        <a asp-controller="CustomRequest" asp-action="Create" class="btn btn-outline-light hero-btn-mobile">Bespoke Design</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Manual Navigation Controls -->
        <button class="carousel-control-prev" type="button" data-bs-target="#heroMobileCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon p-2" aria-hidden="true">
                 <i class="bi bi-chevron-left"></i>
            </span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroMobileCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon p-2" aria-hidden="true">
                <i class="bi bi-chevron-right"></i>
            </span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>

<!-- Value Statements -->
<!-- Value Statements -->
@if (!string.IsNullOrEmpty(Model.Settings.ValueStatements))
{
    var statements = Model.Settings.ValueStatements.Split(new[] { '\r', '\n' }, StringSplitOptions.RemoveEmptyEntries);
    
    <div class="container my-5 py-5 border-bottom border-light">
        <!-- Desktop Grid -->
        <div class="row text-center g-5 d-none d-md-flex">
            @foreach (var statement in statements)
            {
                <div class="col-md-4">
                    <div class="p-4 h-100 d-flex flex-column align-items-center justify-content-center">
                        <i class="bi bi-gem fs-2 mb-3 text-gold"></i>
                        <h4 class="h6 text-uppercase letter-spacing-2 mb-0">@statement</h4>
                    </div>
                </div>
            }
        </div>

        <!-- Mobile Carousel -->
        <div id="valuesMobileCarousel" class="carousel slide d-md-none carousel-dark-arrows-inverse" data-bs-ride="carousel">
             <div class="carousel-inner">
                @{ var isFirst = true; }
                @foreach (var statement in statements)
                {
                    <div class="carousel-item @(isFirst ? "active" : "")" data-bs-interval="4000">
                        <div class="p-5 d-flex flex-column align-items-center justify-content-center text-center">
                            <i class="bi bi-gem fs-1 mb-3 text-gold animate-fade-in-up"></i>
                            <h4 class="h6 text-uppercase letter-spacing-2 mb-0 animate-fade-in-up delay-100">@statement</h4>
                        </div>
                    </div>
                    { isFirst = false; }
                }
            </div>
             <button class="carousel-control-prev" type="button" data-bs-target="#valuesMobileCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true">
                    <i class="bi bi-chevron-left text-dark"></i>
                </span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#valuesMobileCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true">
                    <i class="bi bi-chevron-right text-dark"></i>
                </span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
}

<!-- Signature Pieces -->
@if (Model.SignaturePieces.Any())
{
    <section class="container my-5 py-5">
        <div class="text-center mb-5 animate-fade-in-up">
            <span class="text-secondary text-uppercase letter-spacing-2 small d-block mb-2">Curated Selection</span>
            <h2 class="display-5 serif-font mb-4">Signature Pieces</h2>
            <div class="separator-line mx-auto"></div>
        </div>

        <!-- Desktop Carousel (3 Items Per Slide) -->
        <div id="signatureDesktopCarousel" class="carousel slide d-none d-md-block carousel-dark-arrows-inverse px-md-5 position-relative" data-bs-ride="carousel">
            <div class="carousel-inner">
                @{
                    var sigList = Model.SignaturePieces.ToList();
                    var chunkSize = 3;
                    var chunkCount = (int)Math.Ceiling((double)sigList.Count / chunkSize);
                }
                @for (int i = 0; i < chunkCount; i++)
                {
                    var chunk = sigList.Skip(i * chunkSize).Take(chunkSize).ToList();
                    <div class="carousel-item @(i == 0 ? "active" : "")" data-bs-interval="6000">
                        <div class="row g-4">
                            @foreach (var product in chunk)
                            {
                                var primaryImage = product.Images.FirstOrDefault(i => i.IsPrimary) ?? product.Images.FirstOrDefault();
                                <div class="col-md-4">
                                    <div class="card product-card h-100 border-0 shadow-sm bg-white">
                                        <div class="position-relative overflow-hidden">
                                            <a asp-controller="Catalog" asp-action="Details" asp-route-id="@product.Id" class="d-block overflow-hidden">
                                                @if (primaryImage != null)
                                                {
                                                    <img src="@primaryImage.ImageUrl" class="card-img-top product-image zoom-effect" alt="@product.Name" style="animation-duration: 15s;">
                                                }
                                                else
                                                {
                                                    <div class="placeholder-bg d-flex align-items-center justify-content-center product-image-fallback">
                                                        <span class="text-muted">No Image</span>
                                                    </div>
                                                }
                                            </a>
                                            <div class="product-overlay d-flex align-items-center justify-content-center glass-effect border-0">
                                                <a asp-controller="Catalog" asp-action="Details" asp-route-id="@product.Id" class="btn btn-dark rounded-0 px-4 py-3 shadow-lg">VIEW DETAILS</a>
                                            </div>
                                        </div>
                                        <div class="card-body text-center mt-3 pb-4">
                                            <h5 class="card-title serif-font mb-2"><a asp-controller="Catalog" asp-action="Details" asp-route-id="@product.Id" class="text-decoration-none text-dark hover-underline">@product.Name</a></h5>
                                            <p class="text-secondary mb-0 small text-uppercase letter-spacing-1">From @product.BasePrice.ToString("C0")</p>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
            @if(chunkCount > 1)
            {
                <button class="carousel-control-prev" type="button" data-bs-target="#signatureDesktopCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true">
                        <i class="bi bi-chevron-left fs-3"></i>
                    </span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#signatureDesktopCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true">
                        <i class="bi bi-chevron-right fs-3"></i>
                    </span>
                    <span class="visually-hidden">Next</span>
                </button>
            }
        </div>

        <!-- Mobile Carousel (Single Item) -->
        <div id="signatureMobileCarousel" class="carousel slide d-md-none carousel-dark-arrows-inverse" data-bs-ride="carousel">
            <div class="carousel-inner">
                @{ var firstSig = true; }
                @foreach (var product in Model.SignaturePieces)
                {
                    var primaryImage = product.Images.FirstOrDefault(i => i.IsPrimary) ?? product.Images.FirstOrDefault();
                    <div class="carousel-item @(firstSig ? "active" : "")" data-bs-interval="4000">
                        <div class="mobile-carousel-item px-2">
                            <div class="card product-card border-0 bg-white shadow-sm">
                                <div class="position-relative overflow-hidden">
                                     <a asp-controller="Catalog" asp-action="Details" asp-route-id="@product.Id" class="d-block overflow-hidden">
                                         @if (primaryImage != null)
                                         {
                                             <img src="@primaryImage.ImageUrl" class="card-img-top product-image zoom-effect" alt="@product.Name" style="animation-duration: 15s;">
                                         }
                                         else
                                         {
                                             <div class="placeholder-bg d-flex align-items-center justify-content-center product-image-fallback">
                                                <span class="text-muted">No Image</span>
                                             </div>
                                         }
                                     </a>
                                     <div class="product-overlay d-flex align-items-center justify-content-center glass-effect border-0">
                                         <a asp-controller="Catalog" asp-action="Details" asp-route-id="@product.Id" class="btn btn-dark rounded-0 px-4 py-3 shadow-lg">VIEW DETAILS</a>
                                     </div>
                                </div>
                                <div class="card-body text-center mt-3">
                                    <h5 class="serif-font mb-2">@product.Name</h5>
                                    <p class="text-secondary mb-0 small uppercase">From @product.BasePrice.ToString("C0")</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    { firstSig = false; }
                }
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#signatureMobileCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true">
                    <i class="bi bi-chevron-left text-dark"></i>
                </span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#signatureMobileCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true">
                     <i class="bi bi-chevron-right text-dark"></i>
                </span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        <div class="text-center mt-5">
            <a asp-controller="Catalog" asp-action="Index" class="btn btn-outline-dark rounded-0 px-5">View All Products</a>
        </div>
    </section>
}

<!-- Categories Grid -->
@if (Model.Categories.Any())
{
    <section class="bg-light py-5">
        <div class="container my-5">
            <div class="text-center mb-5">
                <h2 class="display-5 serif-font">Our Collections</h2>
                <div class="separator-line mx-auto mt-3"></div>
            </div>
            <!-- Desktop Collections Carousel (3 Items Per Slide) -->
            <div id="collectionsDesktopCarousel" class="carousel slide d-none d-md-block carousel-dark-arrows-inverse px-md-5 position-relative" data-bs-ride="carousel">
                <div class="carousel-inner">
                    @{
                        var catList = Model.Categories.ToList();
                        var catChunkSize = 3;
                        var catChunkCount = (int)Math.Ceiling((double)catList.Count / catChunkSize);
                    }
                    @for (int i = 0; i < catChunkCount; i++)
                    {
                        var chunk = catList.Skip(i * catChunkSize).Take(catChunkSize).ToList();
                        <div class="carousel-item @(i == 0 ? "active" : "")" data-bs-interval="7000">
                            <div class="row g-4 justify-content-center">
                                @foreach (var cat in chunk)
                                {
                                    <div class="col-md-4">
                                        <a asp-controller="Catalog" asp-action="Index" asp-route-categoryId="@cat.Id" class="text-decoration-none">
                                            <div class="category-card position-relative overflow-hidden text-white category-card-height shadow-sm">
                                                @if (!string.IsNullOrEmpty(cat.ImageUrl))
                                                {
                                                    <img src="@cat.ImageUrl" class="w-100 h-100 object-fit-cover category-image zoom-effect" alt="@cat.Name" style="animation-duration: 20s;">
                                                }
                                                <div class="category-overlay position-absolute top-0 start-0 w-100 h-100"></div>
                                                
                                                <div class="category-content position-absolute top-50 start-50 translate-middle text-center w-100 p-3">
                                                    <h3 class="display-6 serif-font mb-0 text-white text-shadow">@cat.Name</h3>
                                                    <span class="btn btn-light btn-sm mt-3 px-4 rounded-0 text-uppercase letter-spacing-1 btn-reveal">Browse Collection</span>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                </div>
                @if(catChunkCount > 1)
                {
                    <button class="carousel-control-prev" type="button" data-bs-target="#collectionsDesktopCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true">
                            <i class="bi bi-chevron-left fs-3"></i>
                        </span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#collectionsDesktopCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true">
                            <i class="bi bi-chevron-right fs-3"></i>
                        </span>
                        <span class="visually-hidden">Next</span>
                    </button>
                }
            </div>

            <!-- Mobile Collections Carousel (Single Item, Polished) -->
            <div id="collectionsMobileCarousel" class="carousel slide d-md-none carousel-dark-arrows-inverse" data-bs-ride="carousel">
                <div class="carousel-inner">
                    @{ var firstCat = true; }
                    @foreach (var cat in Model.Categories)
                    {
                        <div class="carousel-item @(firstCat ? "active" : "")" data-bs-interval="4500">
                            <div class="mobile-carousel-item px-2">
                                <div class="card product-card border-0 bg-white shadow-sm">
                                    <div class="position-relative overflow-hidden">
                                        <a asp-controller="Catalog" asp-action="Index" asp-route-categoryId="@cat.Id" class="d-block overflow-hidden">
                                            @if (!string.IsNullOrEmpty(cat.ImageUrl))
                                            {
                                                <img src="@cat.ImageUrl" class="card-img-top product-image zoom-effect" alt="@cat.Name" style="animation-duration: 20s;">
                                            }
                                        </a>
                                        <div class="product-overlay d-flex align-items-center justify-content-center glass-effect border-0">
                                            <a asp-controller="Catalog" asp-action="Index" asp-route-categoryId="@cat.Id" class="btn btn-dark rounded-0 px-4 py-3 shadow-lg">BROWSE</a>
                                        </div>
                                    </div>
                                    <div class="card-body text-center mt-3">
                                        <h5 class="serif-font mb-2">@cat.Name</h5>
                                        <p class="text-secondary mb-0 small uppercase">View Collection</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        { firstCat = false; }
                    }
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#collectionsMobileCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true">
                        <i class="bi bi-chevron-left text-dark"></i>
                    </span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#collectionsMobileCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true">
                         <i class="bi bi-chevron-right text-dark"></i>
                    </span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
    </section>
}

<!-- Custom Request Teaser -->
<!-- Custom Request Teaser -->
<section class="container my-5 py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow-sm border-0">
                <div class="row g-0 align-items-center" style="min-height: 600px;">
                    <!-- Øæá ÃßÈÑ -->
                    <!-- Image Side -->
                    <div class="col-lg-6 order-lg-2 d-flex justify-content-center align-items-center p-3">
                        <div class="w-100" style="max-width: 500px;">
                            <!-- ÖÇÈØ ÇáÚÑÖ -->
                            @if (!string.IsNullOrEmpty(Model.Settings.FeatureImageUrl))
                            {
                                <img src="@Model.Settings.FeatureImageUrl"
                                     class="img-fluid rounded object-fit-cover"
                                     alt="Custom Work"
                                     style="object-position: center;"
                                     onerror="this.src='https://placehold.co/800x600/e5e5e5/1a1a1a?text=Custom+Marblin+Work'" />
                            }
                            else
                            {
                                <img src="/images/custom-work.jpg"
                                     class="img-fluid rounded object-fit-cover"
                                     alt="Custom Work"
                                     onerror="this.src='https://placehold.co/800x600/e5e5e5/1a1a1a?text=Custom+Marblin+Work'" />
                            }
                        </div>
                    </div>

                    <!-- Text Side -->
                    <div class="col-lg-6 order-lg-1 d-flex flex-column justify-content-center p-5">
                        <span class="text-secondary text-uppercase letter-spacing-2 small mb-2">Bespoke Design</span>
                        <h2 class="display-5 serif-font mb-4 text-dark">@Model.Settings.FeatureHeadline</h2>
                        <div class="lead text-secondary mb-4" style="font-size: 1.1rem;">
                            @Model.Settings.FeatureBody
                        </div>
                        @if (!string.IsNullOrEmpty(Model.Settings.FeatureButtonText))
                        {
                            <a href="@(Model.Settings.FeatureButtonUrl ?? "#")"
                               class="btn btn-dark btn-lg rounded-0 px-5">
                                @Model.Settings.FeatureButtonText
                            </a>
                        }
                    </div>

                </div>
            </div>
        </div>
    </div>
</section>


